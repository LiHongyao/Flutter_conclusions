# æ¦‚è¿°

## ç®€ä»‹

- Dart æ˜¯Googleå¼€å‘çš„ï¼Œ**ç±»å‹å®‰å…¨**çš„ï¼Œ**é¢å‘å¯¹è±¡**çš„ç¼–ç¨‹è¯­è¨€ï¼Œè¢«åº”ç”¨äº **Wenã€æœåŠ¡å™¨ã€ç§»åŠ¨åº”ç”¨å’Œç‰©è”ç½‘**ç­‰é¢†åŸŸã€‚
- Dart è¯ç”Ÿäº 2011å¹´10æœˆ10æ—¥
- Dart ç®€å•æ˜“å­¦ï¼ˆç±»ä¼¼TypeScripï¼Œæ˜¯å¼ºç±»å‹çš„è¯­è¨€ï¼‰
- è¿è¡Œæ–¹å¼
  - åŸç”Ÿè™šæ‹Ÿæœºï¼ˆDart ä»£ç å¯ä»¥è¿è¡Œåœ¨Windowsï¼ŒMacã€Linuxä¸Šï¼‰
  - JavaScript å¼•æ“ï¼ˆDart ä»£ç å¯ä»¥è½¬æˆJSä»£ç ï¼Œç„¶åè¿è¡Œåœ¨æµè§ˆå™¨ä¸Šï¼‰

## èµ„æº

è¦å­¦ä¹ Flutterçš„è¯æˆ‘ä»¬å¿…é¡»é¦–å…ˆå¾—å­¦ä¼šDartã€‚

- å®˜ç½‘
  - ä¸­æ–‡ï¼šhttps://dart.dev/
  - è‹±æ–‡ï¼šhttps://dart.cn/
- åœ¨çº¿è¿è¡Œä»£ç 
  - https://dartpad.cn
- ç”Ÿæ€
  - https://pub.dev

## å¯¹æ¯”

| Dart            | JavaScript        |
| --------------- | ----------------- |
| Flutter         | React             |
| https://pub.dev | https://npmjs.com |
| pub             | npm               |

## SDK å®‰è£…

### windows

[ä¸‹è½½å®‰è£…å·¥å…·åŒ… >>](https://gekorm.com/dart-windows/)

å®‰è£…å®Œæˆååœ¨ `CMD` è¾“å…¥ `dart --version` å‡ºç°ç‰ˆæœ¬å·åˆ™è¡¨ç¤ºå®‰è£…æˆåŠŸã€‚

### macOS

```shell
 $ brew tap dart-lang/dart
 $ brew install dart
```

> **ï¼æ³¨æ„**ï¼šç”±äº Flutter-SDK è‡ªå¸¦ Dartï¼Œå¦‚æœä½ å·²å®‰è£… Flutter-SDKï¼Œåˆ™æ— éœ€åœ¨å®‰è£…ã€‚

## IDE

### Vscodeï¼ˆæ¨èï¼‰

å®‰è£…æ‰©å±•ï¼š

- `Dart`
- `Code Runner`



### Android Studio

åˆ›å»ºçº¯ dart é¡¹ç›®æµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š

1ï¼‰åˆ›å»ºå¿…è¦ç›®å½•æ–‡ä»¶

```shell
$ mkdir dart-learns && cd dart-learns
$ touch main.dart
```

2ï¼‰å°† `dart-learns` æ‹–è‡³ Android Studio å³å¯ã€‚

3ï¼‰é…ç½® `dart-sdk`

# Dart è¯­æ³•åŸºç¡€

å…ˆä»ä¸€ä¸ªå‡½æ•°å¼€å§‹ï¼š

```dart
// å£°æ˜å‡½æ•°
void printInteger(int aNumber) {
  // æ‰“å°åˆ°æ§åˆ¶å°
  print("The number is $aNumber.");
}

// å…¥å£æ–‡ä»¶-åº”ç”¨ä»è¿™é‡Œå¼€å§‹è¿™è¡Œ
void main() {
  //  å£°æ˜å¹¶åˆå§‹åŒ–ä¸€ä¸ªå˜é‡
  var number = 30;
  // è°ƒç”¨å‡½æ•°
  printInteger(number);
}
```

- æ³¨é‡Šè¯­æ³•ä¸ JS ä¸€è‡´ï¼›
- å£°æ˜å‡½æ•°ä¸éœ€è¦å…³é”®å­—ï¼ˆJS ä¸­é€šè¿‡ `function` å…³é”®å­—æ¥å£°æ˜å‡½æ•°ï¼‰ï¼›
- å‡½æ•°å’Œå‚æ•°å‰é¢éƒ½æœ‰ç±»å‹å£°æ˜ï¼Œ`void` è¡¨ç¤ºæ²¡æœ‰è¿”å›å€¼ï¼Œ `int` æ˜¯æ•´å‹æ•°å­—ï¼›
- æ‰“å°ä½¿ç”¨ `print`ï¼ˆJS ä½¿ç”¨ `console.log()`ï¼‰ï¼›
- æ¯è¡Œä»£ç ç»“æŸæ—¶ï¼Œå¿…é¡»å†™ç»“æŸåˆ†å·ï¼ˆ`;`ï¼‰ï¼›
- å­—ç¬¦ä¸²é€šè¿‡å¼•å·åŒ…èµ·æ¥ï¼Œæ”¯æŒæ¨¡æ¿å­—ç¬¦ä¸²ï¼›
- `main` æ˜¯å…¥å£å‡½æ•°ï¼ŒDart åº”ç”¨ç¨‹åºæ€»æ˜¯ä» `main` å‡½æ•°å¼€å§‹æ‰§è¡Œï¼›

- ç”¨ `var` å£°æ˜çš„å˜é‡ï¼Œå…¶æ•°æ®ç±»å‹æ˜¯åŠ¨æ€çš„ï¼›

## æ³¨é‡Š

- å•è¡Œæ³¨é‡Šï¼š`// æˆ‘æ˜¯å•è¡Œæ³¨é‡Š`
- å¤šè¡Œæ³¨é‡Šï¼š`/* æˆ‘æ˜¯å¤šè¡Œæ³¨é‡Š */`
- æ–‡æ¡£æ³¨é‡Šï¼š`/// æˆ‘æ˜¯æ–‡æ¡£æ³¨é‡Š` ï¼ˆTipsï¼šæ–‡æ¡£æ³¨é‡Šæ”¯æŒ markdown è¯­æ³•ï¼‰

## å˜é‡

- å˜é‡æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼ŒDartä¸‡ç‰©çš†å¯¹è±¡ï¼Œå˜é‡å­˜å‚¨çš„æ˜¯å¯¹è±¡çš„å¼•ç”¨
- å£°æ˜å˜é‡
  - æ˜ç¡®æŒ‡å®šç±»å‹ï¼š`int age = 18`
  - ä¸æ˜ç¡®ç±»å‹ï¼š`var age = 18` æˆ– `dynamic age = 18`
- å˜é‡åå¤§å°å†™æ•æ„Ÿï¼ˆ`age` ä¸ `Age` æ˜¯ä¸¤ä¸ªä¸åŒçš„å˜é‡ï¼‰
- å˜é‡é»˜è®¤å€¼æ˜¯ `null`ï¼ˆJS ä¸­å˜é‡é»˜è®¤å€¼æ˜¯ `undefine`ï¼‰
- Dart å˜é‡çš„å€¼ä¸ä¼šè¿›è¡Œéšå¼è½¬æ¢ï¼ˆ`null` ä¸ä¼šè‡ªåŠ¨è½¬æˆ `false`ï¼‰

## å¸¸é‡

- å¸¸é‡å°±æ˜¯å€¼ä¸å¯å˜çš„å˜é‡ï¼ˆä¸€æ—¦å£°æ˜ï¼Œå…¶å€¼ä¸èƒ½æ›´æ”¹ï¼‰

- å£°æ˜å¸¸é‡ï¼š

  ```dart
  const age = 18;
  final age = 18;
  
  ```

- `const` ä¸ `final` çš„åŒºåˆ«

  ```dart
  const time = DateTime.now(); // æŠ¥é”™ - æ— æ³•å°†è¿è¡Œæ—¶çš„å€¼åˆ†é…ç»™ const å˜é‡ï¼ˆç¼–è¯‘æ—¶ï¼‰
  final time = DateTime.now(); // æˆåŠŸ - å¯ä»¥å°†è¿è¡Œæ—¶çš„å€¼åˆ†é…ç»™ final å˜é‡ï¼ˆè¿è¡Œæ—¶ï¼‰
  ```


# Dart æ•°æ®ç±»å‹

- åŸºæœ¬ç±»å‹ï¼š`int`ã€`double`ã€`String`ã€`bool`
- å¯¹è±¡ç±»å‹ï¼š`List`ã€`Set`ã€`Map`

## Number

Dart ä¸­çš„æ•°å­—ç”±ä¸‰ä¸ªå…³é”®å­—æè¿°

- `num` æ•°å­—ç±»å‹ï¼ˆæ—¢å¯ä»¥æ˜¯æ•´æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯å°æ•°ï¼‰
  - `int` è¡¨ç¤ºæ•´æ•°ï¼ˆå¿…é¡»æ˜¯æ•´æ•°ï¼‰
  - `double` è¡¨ç¤ºæµ®ç‚¹æ•°ï¼ˆæ—¢å¯ä»¥æ˜¯æ•´æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯å°æ•°ï¼‰
- å¸¸ç”¨API
  - https://api.dart.cn/stable/dart-core/num-class.html
  - https://api.dart.cn/stable/dart-core/int-class.html
  - https://api.dart.cn/stable/dart-core/double-class.html

## String

- å£°æ˜å­—ç¬¦ä¸²
  - å•å¼•å·ã€åŒå¼•å·éƒ½å¯ä»¥
  - ä¸‰ä¸ªå¼•å·å¯ä»¥å£°æ˜åŒ…å«æ¢è¡Œç¬¦çš„å­—ç¬¦ä¸²
- å¸¸è§API
  - https://api.dart.cn/stable/dart-core/String-class.html
- æ­£åˆ™è¡¨è¾¾å¼
  - `RegExp(r'æ­£åˆ™è¡¨è¾¾å¼')`
  - `RegExp(r'\d+')`

## Boolean

- Dart é€šè¿‡ `bool` å…³é”®å­—æ¥è¡¨ç¤ºå¸ƒå°”ç±»å‹

- å¸ƒå°”ç±»å‹åªæœ‰ä¸¤ä¸ªå€¼ï¼š`true` å’Œ `false`

- å¯¹å˜é‡è¿›è¡Œåˆ¤æ–­æ—¶ï¼Œè¦æ˜¾ç¤ºåœ°æ£€æŸ¥å¸ƒå°”å€¼

  ```dart
  if(varname){...} // Wrong
  if(varname == 0) {...} // OK
  if(varname == null) {...} // OK
  ```

## List

- Dart ä¸­çš„æ•°ç»„ï¼Œç”± `List` å¯¹è±¡è¡¨ç¤ºã€‚List æœ‰ä¸¤ç§å£°æ˜æ–¹å¼ï¼š

  ```dart
  // å­—é¢é‡æ–¹å¼
  List list = []; // ä¸é™å®šå…ƒç´ çš„æ•°æ®ç±»å‹
  List list = <int>[]; // é™å®šå…ƒç´ çš„æ•°æ®ç±»å‹æ˜¯ int
  // æ„é€ å‡½æ•°æ–¹å¼
  List list = new List.empty(growable: true); // ä¸é™åˆ¶é•¿åº¦çš„ç©ºåˆ—è¡¨
  List list = new List.filled(3, 0); // å£°æ˜æŒ‡å®šé•¿åº¦çš„å¡«å……åˆ—è¡¨

- æ‰©å±•æ“ä½œç¬¦ ï¼ˆ`...`ï¼‰

  ```dart
  var list1 = [1, 2, 3];
  var list2 = [0, ...list]; // - [0, 1, 2, 3]
  ```

- å¸¸ç”¨ API

  - https://api.dart.cn/stable/dart-core/List-class.html

- éå†æ•°ç»„

  - `forEach()`ï¼šéå†åˆ—è¡¨
  - `map()`ï¼šéå†å¹¶å¤„ç†å…ƒç´ ï¼Œç„¶åç”Ÿæˆæ–°çš„åˆ—è¡¨
  - `where()`ï¼šè¿”å›æ»¡è¶³æ¡ä»¶çš„æ•°æ®ï¼Œç±»ä¼¼äº `filters`
  - `any()`ï¼šåªè¦æœ‰ä¸€é¡¹æ»¡è¶³æ¡ä»¶ï¼Œå³è¿”å› `true`
  - `every()`ï¼šåˆ¤æ–­æ˜¯å¦æ¯ä¸€é¡¹éƒ½æ»¡è¶³æ¡ä»¶ï¼Œéƒ½æ»¡è¶³æ¡ä»¶æ‰è¿”å› `true`

## Set

- Set æ˜¯ä¸€ä¸ªæ— åºçš„ï¼Œå…ƒç´ å”¯ä¸€çš„é›†åˆ
- Set æœ‰å­—é¢é‡å’Œæ„é€ å‡½æ•°ä¸¤ç§å£°æ˜æ–¹å¼ï¼ˆ**å­—é¢é‡ä¸­ç”¨å¤§æ‹¬å·**ï¼‰
- æ— æ³•é€šè¿‡ä¸‹æ ‡å–å€¼
- å…·æœ‰é›†åˆç‰¹æœ‰çš„æ“ä½œ
  - ä¾‹å¦‚ï¼šæ±‚äº¤é›†ã€å¹¶é›†ã€å·®é›†ç­‰
- å¸¸ç”¨ API
  - https://api.dart.cn/stable/dart-core/Set-class.html

## Map

- Map æ˜¯ä¸€ä¸ªæ— åºçš„ **é”®å€¼å¯¹ï¼ˆ`key-value`ï¼‰æ˜ å°„**ã€‚é€šå¸¸è¢«ç§°ä¸º **å“ˆå¸Œ** æˆ– **å­—å…¸**ã€‚

- å£°æ˜æ–¹å¼

  ```dart
  // å­—é¢é‡
  var map = { key1: value1, key2: value2 };
  // æ„é€ å‡½æ•°
  var map = new Map();
  map['key'] = value;
  ```

- å¸¸ç”¨ API

  - https://api.dart.cn/stable/dart-core/Map-class.html

## å…¶ä»–

- Runesï¼ˆç¬¦æ–‡ï¼‰
  - Runes å¯¹è±¡æ˜¯ä¸€ä¸ª32ä½å­—ç¬¦å¯¹è±¡ã€‚å®ƒå¯ä»¥æŠŠæ–‡å­—è½¬æ¢æˆ **ç¬¦å·è¡¨æƒ…** æˆ– **ç‰¹å®šçš„æ–‡å­—**ã€‚
  - `print("\u{1f44d}")`  â†’ ğŸ‘
  - https://copychar.cc/
- Symbol
  - åœ¨ Dart ä¸­ä½¿ç”¨ `#` å¼€å¤´æ¥è¡¨ç¤ºçš„æ ‡è¯†ç¬¦
- dynamic
  - åŠ¨æ€æ•°æ®ç±»å‹

# Dart è¿ç®—ç¬¦ä¸è¡¨è¾¾å¼

- ç®—æ•°è¿ç®—ç¬¦ï¼š`+`ã€`-`ã€`*`ã€`/`ã€`%`
- å…³ç³»è¿ç®—ç¬¦ï¼š`>`ã€`==`ã€`<` ...ï¼ˆæç¤ºï¼šä¸æ”¯æŒ `===`ï¼‰
- é€»è¾‘è¿ç®—ç¬¦ï¼š`&&`ã€`||`ã€`ï¼`
- èµ‹å€¼è¿ç®—ç¬¦ï¼š`=`
- å¤åˆè¿ç®—ç¬¦ï¼š`+=`ã€`*=` ....
- ä¸‰å…ƒè¿ç®—ç¬¦ï¼š`?:`
- åœ°æ¿é™¤ï¼š`~/`ï¼Œå¯¹é™¤æ³•è¿ç®—çš„ç»“æœåšå‘ä¸‹å–æ•´çš„æ“ä½œ*ï¼ˆDartç‰¹æœ‰ï¼‰*
- ç±»å‹åˆ¤æ–­è¿ç®—ç¬¦ï¼š`is | is!`ï¼Œç±»ä¼¼äºJSä¸­çš„ `instanceof`*ï¼ˆDartç‰¹æœ‰ï¼‰*
- é¿ç©ºè¿ç®—ç¬¦ï¼š`?? | ??=`ï¼Œå¦‚æœå˜é‡ä¸ºç©ºï¼Œæ‰èµ‹å€¼*ï¼ˆDartç‰¹æœ‰ï¼‰*
- æ¡ä»¶å±æ€§è®¿é—®ï¼š`?.`*ï¼ˆDartç‰¹æœ‰ï¼‰*
- çº§è”è¿ç®—ç¬¦ï¼š`..`*ï¼ˆDartç‰¹æœ‰ï¼‰*
  - `myObject.myMethod()` â†’ è¿”å› `myMethod` çš„è¿”å›å€¼
  - `myObject..myMethod()` â†’ è¿”å› `myObject` å¯¹è±¡çš„å¼•ç”¨

# Dart ç¨‹åºç»“æ„

- åˆ†æ”¯è¯­å¥ï¼š`switch`
- æ¡ä»¶è¯­å¥ï¼š`if-else`

- å¾ªç¯è¯­å¥ï¼š`for`ã€`while`ã€`do...while`

# Dart å‡½æ•°

## å£°æ˜å‡½æ•°

- ç›´æ¥å£°æ˜
  - Dart ä¸­å£°æ˜å‡½æ•°ä¸éœ€è¦ `function` å…³é”®å­—
- ç®­å¤´å‡½æ•°
  - Dart ä¸­çš„ç®­å¤´å‡½æ•°ï¼Œ**å‡½æ•°ä½“åªèƒ½å†™ä¸€è¡Œä¸”ä¸èƒ½å¸¦æœ‰ç»“æŸçš„åˆ†å·**
  - Dart ä¸­çš„ç®­å¤´å‡½æ•°ï¼Œåªæ˜¯å‡½æ•°çš„ä¸€ç§ç®€å†™å½¢å¼
- åŒ¿åå‡½æ•°
- ç«‹å³æ‰§è¡Œå‡½æ•°

ä»£ç ç¤ºä¾‹ï¼š

```dart
// Dart ä¸­å£°æ˜å‡½æ•°ï¼Œä¸éœ€è¦ function å…³é”®å­—
void printInfo() {
  print("Hello, World!");
}

// è¿”å›å€¼ï¼Œä¸å‡½æ•°å£°æ˜çš„ç±»å‹è¦ä¸€è‡´
int getNum() {
  return 1;
}

void main(List<String> args) {
  // -- è°ƒç”¨å‡½æ•°
  printInfo();
  print(getNum());

  // -- åŒ¿åå‡½æ•°
  var myPrint = (value) {
    print(value);
  };
  List fruits = ['apple', "banana", "watermelon"];
  fruits.forEach(myPrint);

  // -- ç®­å¤´å‡½æ•°
  fruits.forEach((element) => print(element) /*ç®­å¤´å‡½æ•°ä¸­ï¼Œä¸èƒ½å†™ç»“æŸçš„åˆ†å¥½(;)ï¼ŒèŠ±æ‹¬å·å¯çœç•¥*/);

  // -- ç«‹å³æ‰§è¡Œå‡½æ•°
  ((String name) {
    print("Hello, $name!");
  })("Lee");
}
```

## å‡½æ•°å‚æ•°

- å¿…å¡«å‚æ•°ï¼šå‚æ•°ç±»å‹ å‚æ•°åç§°ï¼Œå¦‚ `int a`
- å¯é€‰å‚æ•°
  - æ”¾åœ¨å¿…å¡«å‚æ•°åé¢
  - é€šè¿‡ **ä¸­æ‹¬å·** åŒ…è£¹èµ·æ¥
  - å¸¦é»˜è®¤å€¼çš„å¯é€‰å‚æ•°
- å‘½åå‚æ•°
  - ç”¨ **å¤§æ‹¬å·** åŒ…è£¹èµ·æ¥
  - è°ƒç”¨å‡½æ•°æ—¶ï¼Œå‘½åå‚æ•°çš„åç§°ä¸å£°æ˜å‡½æ•°ä¸­çš„åç§°ä¿æŒä¸€è‡´
- å‡½æ•°å‚æ•°

ä»£ç ç¤ºä¾‹ï¼š

```dart
void main(List<String> args) {
  // -- å¿…å¡«å‚æ•°
  String userInfos1(String name) {
    return "ä½ å¥½ï¼š$name";
  }

  String res1 = userInfos1("å¼ ä¸‰");
  print(res1);

  // -- å¯é€‰å‚æ•°
  String userInfos2(String name, [int age = 0]) {
    return "ä½ å¥½ï¼š$nameï¼Œå¹´é¾„ï¼š$age";
  }

  String res2 = userInfos2("å¼ ä¸‰", 20);
  print(res2);

  // -- å‘½åå‚æ•°
  String userInfos3(String name, {int age = 0}) {
    return "ä½ å¥½ï¼š$nameï¼Œå¹´é¾„ï¼š$age";
  }

  /** å‘½åå‡½æ•°è°ƒç”¨æ—¶ï¼Œéœ€è¦ä¸å£°åæ—¶çš„å½¢å‚ä¸€è‡´ */
  String res3 = userInfos3("å¼ ä¸‰", age: 20);
  print(res3);

  // -- å‡½æ•°å‚æ•°
  var myPrint = (value) {
    print(value);
  };
  List fruits = ['apple', "banana", "watermelon"];
  /** å°†åŒ¿åå‡½æ•° myPrint ä¼ é€’ç»™å‡½æ•° forEach */
  fruits.forEach(myPrint);
}
```

## ä½œç”¨åŸŸä¸é—­åŒ…

1ï¼‰ä½œç”¨åŸŸ

```dart
void main(List<String> args) {
  Function funA() {
    print('funA');
    Function funB() {
      print('funB');
      void funC() {
        print('funC');
      }

      return funC;
    }

    return funB;
  }

  var a = funA();
  var b = a();
  b(); // funC
}
```

ä½œç”¨åŸŸé“¾ï¼š`Global` â†’ `funA` â†’ `funB` â†’ `funC`

> **ï¼æç¤ºï¼š** Dart ä¸­çš„ä½œç”¨åŸŸä¸ JavaScript ä¸€è‡´ã€‚

2ï¼‰é—­åŒ…

- Dart ä¸­é—­åŒ…çš„å®ç°æ–¹å¼ä¸ JavaScript å®Œå…¨ä¸€è‡´
- ä½¿ç”¨æ—¶æœºï¼šæ—¢èƒ½é‡ç”¨å˜é‡ï¼Œåˆèƒ½ä¿æŠ¤å˜é‡ä¸è¢«æ±¡æŸ“
- å®ç°åŸç†ï¼šå¤–å±‚å‡½æ•°è¢«è°ƒç”¨åï¼Œå¤–å±‚å‡½æ•°çš„ä½œç”¨åŸŸå¯¹è±¡ï¼ˆAOï¼‰è¢«å†…å±‚å‡½æ•°å¼•ç”¨ç€ï¼Œå¯¼è‡´å¤–å±‚å‡½æ•°çš„ä½œç”¨åŸŸå¯¹è±¡æ— æ³•é‡Šæ”¾ï¼Œä»è€Œå½¢æˆé—­åŒ…ã€‚

ä»£ç ç¤ºä¾‹ï¼š

```dart
// å…¨å±€å˜é‡
var globalNum = 100;
void main(List<String> args) {
  // -- ä½œç”¨åŸŸ
  printInfo() {
    // å±€éƒ¨å˜é‡
    var localNum = 10;
    print(localNum);
    print(globalNum); // å¯ä»¥å†å‡½æ•°ä½œç”¨åŸŸä¸­ï¼Œè®¿é—®å…¨å±€å˜é‡
  }

  printInfo();
  // print(localNum); // ä¸èƒ½åœ¨å…¨å±€ä½œç”¨åŸŸä¸­ï¼Œè®¿é—®å±€éƒ¨å˜é‡

  // -- é—­åŒ…
  parent() {
    var money = 1000;
    return () {
      money -= 100;
      print(money);
    };
  }

  var p = parent();
  p(); // 900
  p(); // 800
  p(); // 700
}
```

## å¼‚æ­¥å‡½æ•°

- JavaScript ä¸­ï¼Œå¼‚æ­¥è°ƒç”¨é€šè¿‡ `Promise` æ¥å®ç°
  - `async` å‡½æ•°è¿”å›ä¸€ä¸ª `Promise`ï¼Œ`await` ç”¨äºç­‰å¾… `Promise`
- Dart ä¸­ï¼Œå¼‚æ­¥è°ƒç”¨é€šè¿‡ `Future` æ¥å®ç°
  - `async` å‡½æ•°è¿”å›ä¸€ä¸ª `Future`ï¼Œ`await` ç”¨äºç­‰å¾… `Future`
- Future è¯¦æƒ…ï¼š
  - https://api.dart.dev/stable/dart-async/Future-class.html

ä»£ç ç¤ºä¾‹1ï¼š`then` å†™æ³•

```dart
// â†’ https://pub.flutter-io.cn/packages/http
import 'package:http/http.dart' as http;
import 'dart:convert';

Future getIPAddress() {
  final uri = Uri.parse('https://httpbin.org/ip');
  return http.get(uri).then((response) {
    String ip = jsonDecode(response.body)['origin'];
    return ip;
  });
}

void main(List<String> args) {
  // è°ƒç”¨ getIPAddress
  getIPAddress()
      .then((ip) => print("IPï¼š$ip"))
      .catchError((error) => print(error));
}
```

ä»£ç ç¤ºä¾‹2ï¼š`async` å†™æ³•

```dart
// â†’ https://pub.flutter-io.cn/packages/http
import 'package:http/http.dart' as http;
import 'dart:convert';

Future getIPAddress() async {
  final uri = Uri.parse('https://httpbin.org/ip');
  final response = await http.get(uri);
  String ip = jsonDecode(response.body)['origin'];
  return ip;
}

void main(List<String> args) async {
  // è°ƒç”¨ getIPAddress
  try {
    final ip = await getIPAddress();
    print("IPï¼š$ip");
  } catch (error) {
    print(error);
  }
}
```

# Dart ç±»ä¸å¯¹è±¡

## ç±»

- ç±»æ˜¯é€šè¿‡ `class` å£°æ˜çš„ä»£ç æ®µï¼ŒåŒ…å«å±æ€§å’Œæ–¹æ³•
  - å±æ€§ï¼šç”¨æ¥æè¿°ç±»çš„å˜é‡
  - æ–¹æ³•ï¼šç±»ä¸­çš„å‡½æ•°ç§°ä¸ºç±»çš„æ–¹æ³•
- å¯¹è±¡æ˜¯ç±»çš„ **å®ä¾‹åŒ–** ç»“æœï¼Œå¦‚ï¼š`var obj = new MyClass()`
- ç±»æ˜¯å¯¹è±¡çš„æŠ½è±¡ï¼Œå¯¹è±¡æ˜¯ç±»çš„å…·ä½“å®ç°
- ç¼–ç¨‹æ–¹å¼
  - é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰
  - é¢å‘è¿‡ç¨‹ç¼–ç¨‹ï¼ˆPOPï¼‰

ä»£ç ç¤ºä¾‹ï¼š

```dart

// å£°æ˜ç±»
class Person {
  // ç±»çš„å±æ€§
  String name = "å¼ ä¸‰";
  // ç±»çš„æ–¹æ³•
  void sayHello() {
    print("Helloï¼Œ$nameï¼");
  }
}

void main(List<String> args) {
  // å®ä¾‹åŒ–ç±»ï¼Œç„¶åå¾—åˆ°ä¸€ä¸ªå¯¹è±¡
  Person p = new Person();

  // è®¿é—®ç±»ä¸­çš„å±æ€§
  print(p.name);

  // è®¿é—®ç±»çš„æ–¹æ³•
  p.sayHello();

  // Dart ä¸­ æ‰€æœ‰çš„å†…å®¹éƒ½æ˜¯å¯¹è±¡
  Map m = new Map();
  print(m.length);

  m.addAll({"name": "æå››", "age": 20});
  print(m.length);
}
```

### æ„é€ å™¨ï¼ˆæ„é€ å‡½æ•°ï¼‰

- é»˜è®¤æ„é€ å‡½æ•°
  - ä¸ç±»åŒåçš„æ„é€ å‡½æ•°ï¼Œåœ¨å®ä¾‹åŒ–æ—¶ï¼Œè‡ªåŠ¨è¢«è°ƒç”¨ã€‚
- å‘½åæ„é€ å‡½æ•°
  - åœ¨ç±»ä¸­ä½¿ç”¨å‘½åæ„é€ å™¨ï¼ˆ **ç±»å.å‡½æ•°å**ï¼‰å®ç°å¤šä¸ªæ„é€ å™¨ï¼Œå¯ä»¥æä¾›é¢å¤–çš„æ¸…æ™°åº¦ã€‚
- å¸¸é‡æ„é€ å‡½æ•°
  - å¦‚æœç±»ç”Ÿæˆçš„å¯¹è±¡ä¸ä¼šæ”¹å˜ï¼Œæ‚¨å¯ä»¥é€šè¿‡å¸¸é‡æ„é€ å‡½æ•°ä½¿è¿™äº›å¯¹è±¡æˆä¸ºç¼–è¯‘æ—¶å¸¸é‡ã€‚
- å·¥å‚æ„é€ å‡½æ•°
  - é€šè¿‡ `factory` å£°æ˜ï¼Œå·¥å‚å‡½æ•°ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆå®ä¾‹ï¼Œè€Œæ˜¯é€šè¿‡ä»£ç æ¥å†³å®šè¿”å›çš„å®ä¾‹ã€‚

ä»£ç ç¤ºä¾‹1ï¼šé»˜è®¤æ„é€ å‡½æ•°

```dart
/// å†™æ³•1
class Point1 {
  // num x;
  // num y;
  num x, y;

  // å£°æ˜æ™®é€šæ„é€ å‡½æ•°
  Point1() {
    print("æˆ‘æ˜¯é»˜è®¤æ„é€ å‡½æ•°ï¼Œå®ä¾‹åŒ–æ—¶ï¼Œä¼šç¬¬ä¸€ä¸ªè¢«è°ƒç”¨");

    // -- thiså¯ä»¥çœç•¥
    // x = 0;
    // y = 0;

    // -- å½“å‘½åæŒ‡å‘æœ‰æ­§ä¹‰æ—¶ï¼Œthis ä¸èƒ½çœç•¥
    this.x = 0;
    this.y = 0;
  }
}

/// å†™æ³•2
class Point2 {
  num x, y;

  // å£°æ˜æ™®é€šæ„é€ å‡½æ•°
  Point2(num x, num y) {
    this.x = x;
    this.y = y;
  }
}

/// å†™æ³•3
class Point3 {
  num x, y;

  // å£°æ˜æ™®é€šæ„é€ å‡½æ•°
  Point3(this.x, this.y);
}

void main(List<String> args) {
  var p1 = new Point1();
  print(p1.x);

  var p2 = new Point2(10, 20);
  print(p2.x);

  var p3 = new Point3(10, 20);
  print(p3.x);
}
```

ä»£ç ç¤ºä¾‹2ï¼šå‘½åæ„é€ å‡½æ•°

```dart
class Point {
  num x, y;
  Point(this.x, this.y);

  // å‘½åæ„é€ å‡½æ•°
  Point.origin() {
    x = 0;
    y = 0;
  }

  // å‘½åæ„é€ å‡½æ•°
  Point.fromJson({x: 0, y: 0}) {
    this.x = x;
    this.y = y;
  }
}

void main(List<String> args) {
  // é»˜è®¤åæ ‡
  Point p1 = new Point.origin();
  print(p1.x);

  // æ‰‹åŠ¨è®¾ç½®åæ ‡
  Point p2 = new Point.fromJson(x: 6, y: 6);
  print(p2.x);
}
```

ä»£ç ç¤ºä¾‹3ï¼šå¸¸é‡æ„é€ å‡½æ•°

```dart
class Point {
  num x;
  num y;

  Point(this.x, this.y);
}

class ImmutablePoint {
  // å±æ€§å¿…é¡»é€šè¿‡ final å£°æ˜
  final num x;
  final num y;
  // å¸¸é‡æ„é€ å‡½æ•°å¿…é¡»é€šè¿‡ const å£°æ˜
  const ImmutablePoint(this.x, this.y);
}

void main(List<String> args) {
  var p1 = new Point(1, 2);
  var p2 = new Point(1, 2);
  print(p1 == p2); // false

  // å¸¸é‡æ„é€ å‡½æ•°ï¼Œå¯ä»¥å½“åšæ™®é€šæ„é€ å‡½æ•°ä½¿ç”¨
  var p3 = new ImmutablePoint(1, 2);
  var p4 = new ImmutablePoint(1, 2);
  print(p3 == p4); // false

  // å£°æ˜ä¸å¯å˜å¯¹è±¡ï¼Œå¿…é¡»é€šè¿‡ const å…³é”®å­—
  var p5 = const ImmutablePoint(1, 2);
  var p6 = const ImmutablePoint(1, 2);
  print(p5 == p6); // true

  // å®ä¾‹åŒ–æ—¶ï¼Œnew å…³é”®å­—ï¼Œå¯ä»¥çœç•¥
  var p7 = ImmutablePoint(1, 2);
  var p8 = ImmutablePoint(1, 2);
  print(p7 == p8); // false
}
```

ä»£ç ç¤ºä¾‹4ï¼šå·¥å‚æ„é€ å‡½æ•°

```dart
class Person {
  String name;
  static Person instance;
  // å·¥å‚æ„é€ å‡½æ•°
  factory Person([String name = "åˆ˜å¤‡"]) {
    // å·¥å‚æ„é€ å‡½æ•°ä¸­ï¼Œä¸èƒ½ä½¿ç”¨ this å…³é”®å­—
    // print(this.name);
    if (Person.instance == null) {
      // ç¬¬ä¸€æ¬¡å®ä¾‹åŒ–
      Person.instance = Person.newSelf(name);
    }
    // éç¬¬ä¸€æ¬¡å®ä¾‹åŒ–
    return instance;
  }

  // å‘½åæ„é€ å‡½æ•°
  Person.newSelf(this.name);
}

void main(List<String> args) {
  // å®ä¾‹åŒ–æ“ä½œ
  Person p1 = new Person("å…³ç¾½");
  print(p1.name);

  Person p2 = new Person("å¼ é£");
  print(p2.name);

  print(p1 == p2);
}
```

### è®¿é—®ä¿®é¥°

- Dart ä¸ TypeScript ä¸åŒï¼Œæ²¡æœ‰è®¿é—®ä¿®é¥°ç¬¦ï¼ˆ`public`ã€`protected`ã€`private`ï¼‰
- Dart ç±»ä¸­ï¼Œé»˜è®¤çš„è®¿é—®ä¿®é¥°ç¬¦æ˜¯å…¬å¼€çš„ï¼ˆå³ `public`ï¼‰
- å¦‚æœ **å±æ€§** å’Œ **æ–¹æ³•** ä»¥ `_`ï¼ˆä¸‹åˆ’çº¿ï¼‰å¼€å¤´ï¼Œåˆ™è¡¨ç¤ºç§æœ‰ï¼ˆå³ `private`ï¼‰
- **åªæœ‰æŠŠç±»å•ç‹¬æŠ½ç¦»å‡ºå»ï¼Œç§æœ‰å±æ€§å’Œæ–¹æ³•æ‰èµ·ä½œç”¨**
  - *`lib/xxx.dart`*
  - *`import 'lib/xxx.dart'`*

### Getter å’Œ Setter

- Getterï¼ˆè·å–å™¨ï¼‰æ˜¯é€šè¿‡ `get` å…³é”®å­—ä¿®é¥°çš„æ–¹æ³•
  - å‡½æ•°æ²¡æœ‰å°æ‹¬å·ï¼Œè®¿é—®æ—¶ä¹Ÿæ²¡æœ‰å°æ‹¬å·ï¼ˆåƒè®¿é—®å±æ€§ä¸€æ ·è®¿é—®æ–¹æ³•ï¼‰
- Setterï¼ˆä¿®æ”¹å™¨ï¼‰æ˜¯é€šè¿‡ `set` å…³é”®å­—ä¿®é¥°çš„æ–¹æ³•
  - è®¿é—®æ—¶ï¼Œåƒè®¾ç½®å±æ€§ä¸€æ ·ç»™å‡½æ•°ä¼ å‚

ä»£ç ç¤ºä¾‹ï¼š

```dart
class Circle {
  final double PI = 3.14;
  num r;
  Circle(this.r);

  // -- Getters

  // num area() {
  //   return this.PI * this.r * this.r;
  // }

  /** ä½¿ç”¨ get å£°æ˜çš„æ–¹æ³•ï¼Œä¸èƒ½æœ‰å°æ‹¬å· */
  num get area {
    return this.PI * this.r * this.r;
  }

  // -- Setters
  set setR(value) {
    this.r = value;
  }
}

void main(List<String> args) {
  var c = new Circle(10);

  // é€šè¿‡ Setter ä¿®æ”¹å±æ€§
  c.setR = 20;
  
  // é€šè¿‡ Getter è®¿é—®é¢ç§¯
  print(c.area);
}

```

### åˆå§‹åŒ–åˆ—è¡¨

- ä½œç”¨ï¼šåœ¨æ„é€ å‡½æ•°ä¸­è®¾ç½®å±æ€§çš„é»˜è®¤å€¼
- æ—¶æœºï¼šåœ¨æ„é€ å‡½æ•°ä½“æ‰§è¡Œä¹‹å‰æ‰§è¡Œ
- è¯­æ³•ï¼šä½¿ç”¨é€—å·åˆ†å‰²åˆå§‹åŒ–è¡¨è¾¾å¼
- åœºæ™¯ï¼šå¸¸ç”¨äºè®¾ç½® `final` äº§é‡çš„å€¼

ä»£ç ç¤ºä¾‹ï¼š

```dart
class Rect {
  int width;
  int height;

  // Rect(this.width, this.height);

  // Rect([int width = 2, int height = 2]) {
  //   this.width = width;
  //   this.height = height;
  //   print("${this.width} -- ${this.height}");
  // }

  // Rect({int width = 2, int height = 2}) {
  //   this.width = width;
  //   this.height = height;
  //   print("${this.width} -- ${this.height}");
  // }

  Rect() : width = 4, height = 20 {
    print("${this.width} -- ${this.height}");
  }
}

class Point {
  double x, y, z;

  Point(this.x, this.y, this.z);

  // åˆå§‹åŒ–åˆ—è¡¨çš„ç‰¹æ®Šç”¨æ³•ï¼ˆé‡å®šå‘æ„é€ å‡½æ•°ï¼‰
  Point.twoD(double x, double y) : this(x, y, 0);
}

void main(List<String> args) {
  var r = new Rect();

  var p1 = new Point(1, 2, 3);
  print(p1.z);

  var p2 = new Point.twoD(4, 5);
  print(p2.z);
}
```

### static

- `static` å…³é”®å­—ç”¨æ¥æŒ‡å®šé™æ€æˆå‘˜
  - é€šè¿‡ `static` ä¿®é¥°çš„å±æ€§æ˜¯é™æ€å±æ€§
  - é€šè¿‡ `static` ä¿®é¥°çš„æ–¹æ³•æ˜¯é™æ€æ–¹æ³•
- é™æ€æˆå‘˜å¯ä»¥é€šè¿‡ç±»åç§°ç›´æ¥è®¿é—®ï¼ˆä¸éœ€è¦å®ä¾‹åŒ–ï¼‰
  - å®ä¾‹åŒ–æ—¶æ¯”è¾ƒæ¶ˆè€—èµ„æºçš„ï¼Œå£°æ˜é™æ€æˆå‘˜ï¼Œå¯ä»¥æé«˜ç¨‹åºæ€§èƒ½
- é™æ€æ–¹æ³•ä¸èƒ½è®¿é—®éé™æ€æˆå‘˜ï¼Œéé™æ€æ–¹æ³•å¯ä»¥è®¿é—®é™æ€æˆå‘˜
  - é™æ€æ–¹æ³•ä¸­ä¸èƒ½ä½¿ç”¨ `this` å…³é”®å­—
  - ä¸èƒ½ä½¿ç”¨ `this` å…³é”®å­—ï¼Œè®¿é—®é™æ€å±æ€§

### å…ƒæ•°æ®

- å…ƒæ•°æ®ä»¥ `@` å¼€å¤´ï¼Œå¯ä»¥ç»™ä»£ç æ ‡è®°ä¸€äº›é¢å¤–çš„ä¿¡æ¯
  - å…ƒæ•°æ®å¯ä»¥ç”¨åœ¨åº“ã€ç±»ã€æ„é€ å™¨ã€å‡½æ•°ã€å­—æ®µã€å‚æ•°æˆ–å˜é‡å£°æ˜çš„ç­¾å
- `@override`ï¼ˆ**é‡å†™**ï¼‰
  - æŸæ–¹æ³•æ·»åŠ è¯¥æ³¨è§£åï¼Œè¡¨ç¤ºé‡å†™äº†çˆ¶ç±»ä¸­çš„åŒåæ–¹æ³•
- `@required`ï¼ˆ**å¿…å¡«**ï¼‰
  - å¯ä»¥é€šè¿‡ `@required` æ¥æ³¨è§£ Dart ä¸­çš„å‘½åå‚æ•°ï¼Œç”¨æ¥æŒ‡ç¤ºå®ƒæ˜¯å¿…å¡«å‚æ•°
- `@deprecated`ï¼ˆ**å¼ƒç”¨**ï¼‰
  - è‹¥æŸç±»æˆ–æŸæ–¹æ³•åŠ ä¸Šè¯¥æ³¨è§£ä¹‹åï¼Œè¡¨ç¤ºæ­¤æ–¹æ³•æˆ–ç±»ä¸å†å»ºè®®ä½¿ç”¨

## ç»§æ‰¿

- æ ¹æ®ç±»çš„å…ˆåé¡ºåºï¼Œå¯ä»¥å°†ç±»åˆ†æˆ **çˆ¶ç±»** å’Œ **å­ç±»**
- å­ç±»é€šè¿‡ `extends` å…³é”®å­— **ç»§æ‰¿** çˆ¶ç±»
  - ç»§æ‰¿åï¼Œå­ç±»å¯ä»¥ä½¿ç”¨çˆ¶ç±»ä¸­ï¼Œ**å¯è§çš„** å†…å®¹ï¼ˆå±æ€§æˆ–æ–¹æ³•ï¼‰
- å­ç±»ä¸­ï¼Œå¯ä»¥é€šè¿‡ `@override` å…ƒæ•°æ®æ¥æ ‡è®° â€**è¦†å†™**â€œæ–¹æ³•
  - â€**è¦†å†™**â€œæ–¹æ³•ï¼šå­ç±»ä¸­ä¸çˆ¶ç±»ä¸­åŒåçš„æ–¹æ³•
- å­ç±»ä¸­ï¼Œå¯ä»¥é€šè¿‡ `super` å…³é”®å­—æ¥å¼•ç”¨çˆ¶ç±»ä¸­ï¼Œå¯è§çš„å†…å®¹
  - å±æ€§
  - æ–¹æ³•ï¼ˆæ™®é€šæ„é€ å‡½æ•°ï¼Œå‘½åæ„é€ å‡½æ•°ï¼‰

## æŠ½è±¡ç±»

- æŠ½è±¡ç±»æ˜¯ç”¨ `abstract` å…³é”®å­—ä¿®é¥°çš„ç±»
- æŠ½è±¡ç±»çš„ **ä½œç”¨** æ˜¯å……å½“æ™®é€šç±»çš„æ¨¡æ¿ï¼Œçº¦å®šä¸€äº›å¿…è¦çš„å±æ€§å’Œæ–¹æ³•
- **æŠ½è±¡æ–¹æ³•** æ˜¯æŒ‡ **æ²¡æœ‰æ–¹æ³•ä½“çš„æ–¹æ³•**
  - æŠ½è±¡ç±»ä¸­ä¸€èˆ¬éƒ½æœ‰æŠ½è±¡æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰æŠ½è±¡æ–¹æ³•
  - æ™®é€šç±»ä¸­ï¼Œä¸èƒ½æœ‰æŠ½è±¡æ–¹æ³•
- æŠ½è±¡ç±»ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼ˆä¸èƒ½è¢« `new`ï¼‰
- æŠ½è±¡ç±»å¯ä»¥è¢«æ™®é€šç±»ç»§æ‰¿ï¼ˆ`extends`ï¼‰
  - å¦‚æœæ™®é€šç±»ç»§æ‰¿æŠ½è±¡ç±»ï¼Œå¿…é¡»å®ç°æŠ½è±¡ç±»ä¸­æ‰€æœ‰çš„æŠ½è±¡æ–¹æ³•
- æŠ½è±¡ç±»è¿˜å¯ä»¥æ˜¯å……å½“æ¥å£è¢«å®ç°ï¼ˆ`implements`ï¼‰
  - å¦‚æœæŠŠæŠ½è±¡ç±»å½“åšæ¥å£å®ç°çš„è¯ï¼Œæ™®é€šç±»å¿…é¡»å¾—å®ç°æŠ½è±¡ç±»é‡Œé¢å®šä¹‰çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•

ä»£ç ç¤ºä¾‹ï¼š

```dart
// 1. æŠ½è±¡ç±»å¿…é¡»é€šè¿‡ abstract å…³é”®å­—å£°æ˜
// 2. æŠ½è±¡ç±»ä¸­ï¼Œå¯ä»¥æœ‰æŠ½è±¡æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰æŠ½è±¡æ–¹æ³•ï¼Œä¸€èˆ¬æ¥è¯´ï¼ŒæŠ½è±¡ç±»éƒ½æœ‰æŠ½è±¡æ–¹æ³•
import '10_metadata.dart';

abstract class Phone {
  // å£°æ˜æŠ½è±¡æ–¹æ³•
  void processor(); // å¤„ç†å™¨
  void camera(); // æ‘„åƒå¤´

  void info() {
    print("æˆ‘æ˜¯æŠ½è±¡ç±»ä¸­çš„ä¸€ä¸ªæ™®é€šæ–¹æ³•");
  }
}

class Xiaomi extends Phone {
  // æ™®é€šç±»ç»§æ‰¿äº†æŠ½è±¡ç±»ï¼Œå°±å¿…é¡»å®ç°æŠ½è±¡ç±»æ‰€æœ‰çš„æŠ½è±¡æ–¹æ³•
  @override
  void processor() {
    print("éªé¾™888");
  }

  @override
  void camera() {
    print("ä¸‰æ˜Ÿæ‘„åƒå¤´");
  }
}

class Huawei extends Phone {
  // æ™®é€šç±»ç»§æ‰¿äº†æŠ½è±¡ç±»ï¼Œå°±å¿…é¡»å®ç°æŠ½è±¡ç±»æ‰€æœ‰çš„æŠ½è±¡æ–¹æ³•
  @override
  void processor() {
    print("éº’éºŸ990");
  }

  @override
  void camera() {
    print("è±å¡æ‘„åƒå¤´");
  }

  // æ™®é€šç±»ä¸­ä¸èƒ½æœ‰æŠ½è±¡æ–¹æ³•
  // void aaa();

}

void main(List<String> args) {
  // æŠ½è±¡ç±»ä¸èƒ½è¢«å®ä¾‹åŒ–
  // var p1 = new Phone();

  Xiaomi m = new Xiaomi();
  m.processor();
  m.camera();
  m.info();

  Huawei h = new Huawei();
  h.processor();
  h.camera();
}

```

## æ¥å£

- æ¥å£åœ¨ Dart ä¸­å°±æ˜¯ä¸€ä¸ªç±»ï¼ˆåªæ˜¯ç”¨æ³•ä¸åŒï¼‰
  - ä¸ Java ä¸åŒï¼ŒJava ä¸­çš„æ¥å£éœ€è¦ç”¨ `interface` å…³é”®å­—å£°æ˜ï¼› Dart ä¸­ä¸éœ€è¦
  - æ¥å£å¯ä»¥æ˜¯ä»»æ„ç±»ï¼Œä½†ä¸€èˆ¬ä½¿ç”¨æŠ½è±¡ç±»åšæ¥å£
- ä¸€ä¸ªç±»å¯ä»¥ **å®ç°ï¼ˆ`implements`ï¼‰** å¤šä¸ªå€Ÿå£ï¼Œå¤šä¸ªæ¥å£ç”¨é€—å·åˆ†å‰²
  - æ¥å£å¯ä»¥çœ‹æˆä¸€ä¸ªä¸ªå°é›¶ä»¶ã€‚ç±»å®ç°æ¥å£å°±ç›¸å½“äºç»„è£…é›¶ä»¶
- æ™®é€šç±»å®ç°æ¥å£åï¼Œå¿…é¡»é‡å†™æ¥å£ä¸­æ‰€æœ‰çš„å±æ€§å’Œæ–¹æ³•

ä»£ç ç¤ºä¾‹ï¼š

```dart
// æ‰‹æœºçš„å¤„ç†å™¨
abstract class Processor {
  String cores; // å†…æ ¸ï¼š2æ ¸ï¼Œ4æ ¸
  arch(String name); // èŠ¯ç‰‡åˆ¶ç¨‹ï¼š7nmï¼Œ5nm
}

// æ‰‹æœºçš„æ‘„åƒå¤´
abstract class Camera {
  String resolution; // åˆ†è¾¨ç‡ï¼š1000ä¸‡ï¼Œ3000ä¸‡
  brand(String name); // å“ç‰Œï¼šä¸‰æ˜Ÿï¼Œè±å¡ï¼Œè”¡å¸
}

// é€šè¿‡æ™®é€šç±»å®ç°æ¥å£
class Phone implements Processor, Camera {
  @override
  String cores;

  @override
  String resolution;

  Phone(this.cores, this.resolution);

  @override
  arch(String name) {
    print("èŠ¯ç‰‡åˆ¶ç¨‹ï¼š$name");
  }

  @override
  brand(String name) {
    print("ç›¸æœºå“ç‰Œï¼š$name");
  }
}

void main(List<String> args) {
  Phone p = new Phone("4æ ¸", "3000ä¸‡");
  p.arch("5nm");
  p.brand("è±å¡");
}
```

## æ··å…¥

- æ··å…¥ï¼ˆMixinï¼‰æ˜¯ä¸€æ®µå…¬å…±ä»£ç ã€‚æ··å…¥æœ‰ä¸¤ç§å£°æ˜æ–¹å¼ï¼š
  - å°†ç±»å½“åšæ··å…¥ â†’ `class MixinA { ... }`
    - ä½œä¸º Mixin çš„ç±»åªèƒ½ç»§æ‰¿è‡ª Objectï¼Œä¸èƒ½ç»§æ‰¿å…¶ä»–ç±»
    - ä½œä¸º Mixin çš„ç±»ä¸èƒ½æœ‰æ„é€ å‡½æ•°
  - é€šè¿‡ `mixin` å…³é”®å­—å£°æ˜ â†’ `mixin MixinB { ... }`
- æ··å…¥ï¼ˆMixinï¼‰å¯ä»¥æé«˜ä»£ç å¤ç”¨çš„æ•ˆç‡ï¼Œæ™®é€šç±»å¯ä»¥é€šè¿‡ `with` æ¥ä½¿ç”¨æ··å…¥
  - `class MyClass with MixinA, MixinB { ... }`
- ä½¿ç”¨å¤šä¸ªæ··å…¥æ—¶ï¼Œåå¼•å…¥çš„æ··å…¥ä¼šè¦†ç›–ä¹‹å‰æ··å…¥ä¸­çš„é‡å¤çš„å†…å®¹
  - MixinA å’Œ MixinBä¸­éƒ½ç”¨ `hello()` æ–¹æ³•ï¼ŒMyClass ä¼šä½¿ç”¨ MixinB ä¸­çš„

ä»£ç ç¤ºä¾‹ï¼š

```dart
class Father {}

// class MixinA extends Father { // ç”¨ä½œæ··å…¥çš„ç±»ï¼Œä¸èƒ½ç»§æ‰¿é™¤äº† Object ä»¥å¤–çš„å…¶ä»–ç±»
// class MixinA extends Object {
class MixinA {
  String name = "MixinA";

  // MixinA(); // ç”¨ä½œæ··å…¥çš„ç±»ï¼Œä¸èƒ½æ‹¥æœ‰æ„é€ å‡½æ•°

  void printA() {
    print("A");
  }

  void run() {
    print("A is running");
  }
}

mixin MixinB {
  String name = "MixinB";
  void printB() {
    print("B");
  }

  void run() {
    print("B is running");
  }
}

class MyClass with MixinA, MixinB {}

void main(List<String> args) {
  var c = new MyClass();
  c.printA();
  c.printB();

  // ï¼æ³¨æ„ï¼šåå¼•å…¥çš„æ··å…¥ï¼Œä¼šè¦†ç›–ä¹‹å‰å¼•å…¥çš„æ··å…¥ä¸­é‡å¤çš„å†…å®¹
  print(c.name); // B
  c.run(); // B is running
}
```

## æ³›å‹

- æ³›å‹æ˜¯åœ¨ **å‡½æ•°ã€ç±»ã€æ¥å£** ä¸­æŒ‡å®š **å®½<u>æ³›</u>æ•°æ®ç±»<u>å‹</u>** çš„è¯­æ³•ã€‚

  - æ³›å‹å‡½æ•°
  - æ³›å‹ç±»
  - æ³›å‹æ¥å£

- é€šå¸¸ï¼Œåœ¨å°–æ‹¬å·ä¸­ï¼Œä½¿ç”¨ä¸€ä¸ªå­—æ¯æ¥ä»£è¡¨ç±»å‹ï¼Œä¾‹å¦‚ï¼šE/T/S/K å’Œ V ç­‰ã€‚

  ```dart
  è¿”å›ç±»å‹ å‡½æ•°å<è¾“å…¥ç±»å‹>(å‚æ•°ç±»å‹ å‚æ•°){
  	å‡½æ•°ä½“
  }
  ```

  ```dart
  T getData<T>(T value) {
  	return value;
  }
  ```

  ![](./IMGS/generics.jpg)

ä»£ç ç¤ºä¾‹ï¼š

```dart
// -- æ³›å‹å‡½æ•°
T getData<T>(T value) {
  return value;
}

// æ³›å‹ç±»
class GenericsClass<T> {
  Set s = new Set<T>();
  
  void add(T value) {
    this.s.add(value);
  }

  void info() {
    print(this.s);
  }
}

// æ³›å‹æ¥å£
abstract class Cache<T> {
  getByKey(String key);
  void setByKey(String key, T value);
}
class FileCache<T> implements Cache<T> {
  @override
  getByKey(String key) {
    return null;
  }

  @override
  void setByKey(String key, T value) {
    print("æ–‡ä»¶ç¼“å­˜ï¼škey = ${key} value = ${value}");
  }
}
```

### æ³›å‹ç±»å‹é™åˆ¶

```dart
class SomeBaseClass {
  // ...
}

class AnotherClass {
  // ...
}

// å­ç±»
class Extender extends SomeBaseClass {}

class Foo<T extends SomeBaseClass> {
  String toString() => "Instance of 'Foo<$T>'";
}

void main(List<String> args) {
  var someBaseClassFoo = Foo<SomeBaseClass>();
  print(someBaseClassFoo);

  var extenderFoo = Foo<Extender>();
  print(extenderFoo);

  var foo = Foo();
  print(foo);

  // var f = Foo<AnotherClass>(); // ç±»å‹ä¸å¯¹ï¼ŒæŠ¥é”™
  // print(f);
}
```

## æšä¸¾

- æšä¸¾æ˜¯æ•°é‡å›ºå®šçš„å¸¸é‡å€¼ï¼Œé€šè¿‡ `enum` å…³é”®å­—å£°æ˜

  ```dart
  enum Color { red, green, blue }
  ```

- æšä¸¾çš„ `values` å¸¸é‡ï¼Œå¯ä»¥è·å–æ‰€æœ‰æšä¸¾å€¼åˆ—è¡¨

  ```dart
  List<Color> colors = Color.values;
  ```

- å¯ä»¥é€šè¿‡ `index` è·å–å€¼çš„ç´¢å¼•

  ```dart
  assert(Color.green.index == 1)
  ```

ä»£ç ç¤ºä¾‹ï¼š

```dart
enum Color { red, green, blue }

void main(List<String> args) {
  // é€šè¿‡ index è¿”å›æ²¡å±…ä¸­å…·ä½“å¸¸é‡çš„å€¼
  print(Color.green.index);

  // é€šè¿‡ values è¿”å›å¸¸é‡åˆ—è¡¨
  print(Color.values);
  List<Color> colors = Color.values;
  print(colors);

  // é€šè¿‡ä¸‹æ ‡ï¼Œè®¿é—®åˆ—è¡¨ä¸­çš„å†…å®¹
  print(colors[0]);

  // é€šè¿‡forEachéå†åˆ—è¡¨çš„å†…å®¹
  colors.forEach((element) {
    print("value: $element, index: ${element.index}");
  });
}

```

# Dart åº“ä¸ç”Ÿæ€

- Dart ä¸­çš„åº“å°±æ˜¯å…·æœ‰ç‰¹å®šåŠŸèƒ½çš„æ¨¡å—

  - å¯èƒ½åŒ…å«å•ä¸ªæ–‡ä»¶ï¼Œä¹Ÿå¯èƒ½åŒ…å«å¤šä¸ªæ–‡ä»¶

- æŒ‰ç…§åº“çš„ä½œè€…è¿›è¡Œåˆ’åˆ†ï¼Œåº“å¯ä»¥åˆ†æˆä¸‰ç±»ï¼š

  - è‡ªå®šä¹‰åº“ï¼ˆå·¥ç¨‹å¸ˆè‡ªå·±å†™çš„ï¼‰
  - ç³»ç»Ÿåº“ï¼ˆDart ä¸­è‡ªå¸¦çš„ï¼‰
  - ç¬¬ä¸‰æ–¹åº“ï¼ˆDart ç”Ÿæ€ä¸­çš„ï¼‰

- Dart ç”Ÿæ€

  - https://pub.dev/
  - https://pub.flutter-io.cn/
  - pub å‘½ä»¤ï¼ˆ*`Flutterå®‰è£…ç›®å½•/bin/cache/dart-sdk/bin`*ï¼‰ 

- å¯¹æ¯”

  | @Dart           | @JavaScript       |
  | --------------- | ----------------- |
  | åº“ï¼ˆlibraryï¼‰   | åŒ…ï¼ˆpackageï¼‰     |
  | https://pub.dev | https://npmjs.com |
  | pubspec.yaml    | package.json      |
  | pub             | npm               |

## è‡ªå®šä¹‰åº“

### é€šè¿‡ `library` æ¥å£°æ˜åº“

- æ¯ä¸ª Dart æ–‡ä»¶é»˜è®¤éƒ½æ˜¯ä¸€ä¸ªåº“ï¼Œåªæ˜¯æ²¡æœ‰ä½¿ç”¨ `library` æ¥æ˜¾ç¤ºå£°æ˜

  ```dart
  // main.dart
  main() {
    print("Helloï¼ŒWorldï¼");
  }
  
  // main.dart
  library main; // é»˜è®¤éšè—äº†ä¸€ä¸ª main çš„ library çš„å£°æ˜
  main() {
    print("Helloï¼ŒWorldï¼");
  }

- Dart ä½¿ç”¨ `_`ï¼ˆä¸‹åˆ’çº¿ï¼‰å¼€å¤´çš„æ ‡è¯†ç¬¦ï¼Œè¡¨ç¤ºåº“å†…è®¿é—®å¯è§ï¼ˆç§æœ‰ï¼‰
- `library` å…³é”®å­—å£°æ˜çš„åº“åç§°å»ºè®®ä½¿ç”¨ï¼šå°å†™å­—æ¯ + ä¸‹åˆ’çº¿ï¼Œå¦‚ `my_custom`

### é€šè¿‡ `import` æ¥å¼•å…¥åº“

- ä¸åŒç±»å‹çš„åº“ï¼Œå¼•å…¥æ–¹å¼ä¸åŒ
  - è‡ªå®šä¹‰åº“ï¼ˆ*`import 'åº“çš„ä½ç½®/åº“åç§°.dart'`*ï¼‰
  - ç³»ç»Ÿåº“ï¼ˆ*`import 'dart:åº“åç§°'`*ï¼‰
  - ç¬¬ä¸‰æ–¹åº“ï¼ˆåé¢å•ç‹¬è®²ï¼‰
- å¼•å…¥éƒ¨åˆ†åº“ï¼ˆä»…å¼•å…¥éœ€è¦çš„å†…å®¹ï¼‰
  - åŒ…å«å¼•å…¥ï¼ˆ`show`ï¼‰
  - æ’é™¤å¼•å…¥ï¼ˆ`hide`ï¼‰
- æŒ‡å®šåº“çš„å‰ç¼€
  - å½“åº“åå†²çªæ—¶ï¼Œå¯ä»¥é€šè¿‡ `as` å…³é”®å­—ï¼Œç»™åº“å£°æ˜ä¸€ä¸ªå‰ç¼€
- å»¶è¿Ÿå¼•å…¥ï¼ˆæ‡’åŠ è½½ï¼‰
  - ä½¿ç”¨ `deferred as` å…³é”®å­—æ¥æ ‡è¯†éœ€è¦å»¶æ—¶åŠ è½½çš„åº“

ä»£ç ç¤ºä¾‹1ï¼šåŒ…å«å¼•å…¥ä¸æ’é™¤å¼•å…¥

*`lib/common.dart`*

```dart
void f1() {
  print("f1 is running");
}

void f2() {
  print("f2 is running");
}

void f3() {
  print("f3 is running");
}
```

*`main.dart`*

```dart
// -- show åé¢æŒ‡å®šåŒ…å«å¼•å…¥çš„å†…å®¹
// -- hide ä¸ show åˆšå¥½ç›¸å
import 'lib/common.dart' show f1, f3;

void main(List<String> args) {
  f1(); // f1 is running
  // f2(); // â†’ æŠ¥é”™
  f3(); // f3 is running
}
```

ä»£ç ç¤ºä¾‹2ï¼šå»¶è¿Ÿå¼•å…¥

*`lib/function.dart`*

```dart
void f1() {
  print("f1 of function is running");
}

void hello() {
  print("Hello");
}
```

*`main.dart`*

```dart
import 'lib/function.dart' deferred as func;

void main(List<String> args) {
  // func.hello(); // -- Deferred library func was not loaded.
  print("1");
  greet();
  print("2");
  print("3");
}

Future greet() async {
  await func.loadLibrary();
  func.hello();
}
```

### `part` ä¸ `part of`

![](./IMGS/part_partof.jpg)



## ç³»ç»Ÿåº“

- ç³»ç»Ÿåº“ï¼ˆä¹Ÿå«æ ¸å¿ƒåº“ï¼‰æ˜¯ Dart æä¾›çš„å¸¸ç”¨å†…ç½®åº“
  - ä¸éœ€è¦å•ç‹¬ä¸‹è½½ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨
- å¼•å…¥ â†’ `import  'dart:åº“å'`
  - `dart:core` è‡ªåŠ¨å¼•å…¥ï¼ˆæ— éœ€æ‰‹åŠ¨å¼•å…¥ï¼‰
- ç³»ç»Ÿåº“åˆ—è¡¨
  - https://dart.cn/guides/libraries

## ç¬¬ä¸‰æ–¹åº“

- æ¥æº

  - https://pub.dev
  - https://pub.flutter-io.cn/packages
  - https://pub.dartlang.org/flutter

- ä½¿ç”¨

  - åœ¨é¡¹ç›®ç›®å½•ä¸‹åˆ›å»º *`pubspec.yaml`*
  - åœ¨ *`pubspec.yaml`* ä¸­å£°æ˜ç¬¬ä¸‰æ–¹åº“ï¼ˆä¾èµ–ï¼‰
  - å‘½ä»¤è¡Œä¸­è¿›å…¥ *`pubspec.yaml`* æ‰€åœ¨ç›®å½•ï¼Œæ‰§è¡Œ `pub get` è¿›è¡Œå®‰è£…
  - é¡¹ç›®ä¸­å¼•å…¥å·²å®‰è£…çš„ç¬¬ä¸‰æ–¹åº“ï¼š`import 'package:xxx/xxx.dart'`

- ç¬¬ä¸‰æ–¹åº“çš„ç»“æ„

  - ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œå¿…é¡»åŒ…å«ä¸€ä¸ª *`pubspec.yaml`* æ–‡ä»¶ï¼Œå¤§è‡´ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š

    ```ini
    dart_string_manip
    .
    â”œâ”€â”€ example
    â”‚	  â””â”€â”€	main.dart
    â”œâ”€â”€ lib
    â”‚	  â”œâ”€â”€ dart_string_manip.dart
    â”‚	  â””â”€â”€	src
    â”‚	  		â”œâ”€â”€ classes.dartat 
    â”‚	  		â””â”€â”€	functions.dart
    â”œâ”€â”€ .gitignore
    â”œâ”€â”€ .packages
    â”œâ”€â”€ LICENSE
    â”œâ”€â”€ README.md
    â”œâ”€â”€ pubspec.lock
    â””â”€â”€	pubspec.yaml
    ```

- pubspec.yaml

  - è¯¦æƒ…ï¼šhttps://dart.cn/tools/pub/pubspec

    ```yaml
    name: flutter_app
    description: A new Flutter application.
    
    publish_to: 'none'
    
    version: 1.0.0+1
    
    environment:
      sdk: '>=2.10.0 <3.0.0'
      
    dependencies:
    	flutter:
    		sdk: flutter
    		
      cupertino_icons: ^1.0.0
      
    dev_dependencies:
      flutter_test:
      	sdk: flutter
      	
    flutter:
    	uses-material-design: true
    ```

    







